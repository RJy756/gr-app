"use strict";$(function(){FastClick.attach(document.body),connectWebViewJavascriptBridge(function(n){function e(){$(".qr-code").empty(),$(".qr-code").qrcode({text:location.protocol+"//"+location.host+"/home/invite/index.html?channel=yqhd"})}function o(e){var o={modalId:"modal1",title:"提示",text:e,type:"0",buttons:[{text:"确定",value:"btn"}]};n.callHandler("modal",o,function(n){})}function t(){c&&$.ajax({url:a+"index.json",type:l,timeout:3e3,headers:{"Http-X-User-Access-Token":c},async:!1,success:function(n,t,i){"string"==typeof n&&(n=JSON.parse(n)),"success"===n.result?n.code?n.message?(e(),o(n.message)):(e(),o("网络异常，请重试")):($(".qr-code").empty(),r=location.protocol+"//"+location.host+"/home/invite/index.html?channel="+n.channelCode,Number(n.awardAmount)>=1e3?$(".a-num").text(" 1千多 "):$(".a-num").text(n.awardAmount),$(".p-num").text(n.inviteCount),$("#hasToken").show(),$(".qr-code").qrcode({text:r})):n.message?(e(),o(n.message)):(e(),o("网络异常，请重试"))},error:function(n,t,i){e(),o("网络异常，请重试")},complete:function(n,t){"timeout"===t&&(e(),o("网络超时，请重试"))}})}function i(){c?($("#noToken").hide(),t()):($("#hasToken").hide(),$("#noToken").show(),e())}var c,r,a=location.protocol+"//"+location.host+"/activity/invite/",l="POST",s=location.protocol+"//"+location.host+"/home/invite/record.html";window.onload=(FastClick.attach(document.body),void $(".spinner-content").hide()),n.registerHandler("returnBackHandler",function(n,e){var o={};o.isFirstPage=!0,e(o)}),n.registerHandler("loginHandler",function(n,e){"string"==typeof n&&(n=JSON.parse(n)),c=n.token,i();var o={};o.triggerId="login",e(o)}),function(){var e,o={triggerId:"getUserToken"};n.callHandler("getUserToken",o,function(o){return null===o?(i(),e={triggerId:"noToken"},void n.callHandler("login",e,function(n){})):o&&("string"==typeof o&&(o=JSON.parse(o)),""===o.token)?(i(),e={triggerId:"noToken"},void n.callHandler("login",e,function(n){})):("string"==typeof o&&(o=JSON.parse(o)),c=o.token,void i())})}(),$("#noToken").click(function(){var e={triggerId:"btnNoToken"};n.callHandler("login",e,function(){})}),$("#hasToken").click(function(){var e={url:s};n.callHandler("openView",e,function(n){})})})});